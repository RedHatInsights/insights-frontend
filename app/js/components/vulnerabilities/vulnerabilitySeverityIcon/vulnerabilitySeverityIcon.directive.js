/*global require*/
'use strict';

const componentsModule = require('../../');

/**
 * @ngInject
 */
function vulnerabilitySeverityIconCtrl ($scope, gettextCatalog) {
    if ($scope.showLabel === undefined) {
        $scope.showLabel = true;
    }

    $scope.$watchGroup(['severity', 'impact'], function ([severity, impact]) {
        if (severity) {
            $scope.value = severity;
            $scope.tooltip = gettextCatalog.getString('RHSA Severity: {{severity}}', {
                severity
            });
        } else if (impact) {
            $scope.value = impact;
            $scope.tooltip = gettextCatalog.getString('CVE Impact: {{impact}}', {impact});
        }
    });
}

function vulnerabilitySeverityIcon() {
    return {
        scope: {
            severity: '<?',
            impact: '<?',
            showLabel: '<'
        },
        templateUrl: 'js/components/vulnerabilities/vulnerabilitySeverityIcon/' +
            'vulnerabilitySeverityIcon.html',
        restrict: 'E',
        replace: true,
        controller: vulnerabilitySeverityIconCtrl
    };
}

componentsModule.directive('vulnerabilitySeverityIcon', vulnerabilitySeverityIcon);
