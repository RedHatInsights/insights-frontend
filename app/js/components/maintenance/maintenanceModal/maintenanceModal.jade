.maintenance-plan-modal.main-content.updatable(ng-class='{updating: loader.loading}')
  .spinner.spinner-lg(ng-if='loader.loading')
  .modal-actions
    .fa.fa-close.pull-right(ng-click='close()')
  .modal-header
    .text-center
      i.rh-icon-book
      h2(translate) Plan / Playbook Builder
  .content-block
    .form-group
      .row.row-short
        .radio.col-sm-4
          label.control-label
            input(type='radio', ng-model='newPlan', ng-value='true')
            strong Create new plan
        .col-sm-8
          input.form-control(
            type='text',
            name='name',
            maxlength='255',
            ng-disabled='!newPlan',
            ng-model='newPlanAlias',
            placeholder="{{'Plan Alias (optional)' | translate}}",
            autofocus)
      .row.row-short
        .radio.col-sm-4
          label.control-label
            input(type='radio', ng-model='newPlan', ng-value='false', ng-disabled='!availablePlans.length')
            strong Add to existing plan
        .col-sm-8
          ui-select(ng-model='selected.plan', append-to-body='false', ng-disabled='newPlan')
            ui-select-match.form-control.ui-select-match(placeholder='Select a plan')
              span(ng-if='!selected.plan.name.length', translate) Untitled plan ({{selected.plan.maintenance_id}})
              span(ng-if='selected.plan.name.length') {{selected.plan.name}}
              span(ng-if='selected.plan.start') &nbsp;- {{selected.plan.start | moment:'LL'}}
            ui-select-choices.ui-select-choices(
              repeat="plan in availablePlans | searchMaintenancePlans: $select.search | orderBy:['start', getPlanName, 'maintenance_id']",
              group-by='planGroupFn',
              group-filter='planOrderFn')
              span(ng-if='!plan.name.length', translate) Untitled plan ({{plan.maintenance_id}})
              span(ng-if='plan.name.length') {{plan.name}}
              span(ng-if='plan.start') &nbsp; - {{plan.start | moment:'LL'}}

    .row.available-actions
      .content-block.maintenance-plan.rule(
        ng-if='plan && tableParams && mode === MODES.rule')
        .header.bordered
          span.icon-inline
            severity-icon(rule="rule")
          strong {{rule.description}}
        .nopad.table-responsive
          maintenance-table-systems(
            params='tableParams',
            edit='tableEdit',
            item='plan',
            on-save='postSave()',
            on-cancel='close()')

      .content-block.maintenance-plan.rule(ng-if='plan && tableParams && mode === MODES.system')
        .header.bordered
          span.icon-inline
            type-icon(type-id='system.system_type_id', include-text='false')
          a(ng-click='showSystemModal(system)')
            strong {{system.toString}} &nbsp;&nbsp;
          span.item
            strong(translate) Last check in:
            span(ng-class='system | checkInStyle') &nbsp;&nbsp;{{system.last_check_in | timeAgo}}
        .nopad.table-responsive
          maintenance-table-actions(
            params='tableParams',
            edit='tableEdit',
            item='plan',
            on-save='postSave()',
            on-cancel='close()')

      .content-block.maintenance-plan.rule(
        ng-if='plan && tableParams && fixableSystems.length && mode === MODES.multi')
        .header.bordered
          strong(
            translate,
            translate-n='fixableSystems.length',
            translate-plural='Available actions for {{$count}} systems') Available actions for 1 system
        .nopad.table-responsive
          maintenance-table-multi(
            params='tableParams',
            edit='tableEdit',
            item='plan',
            on-save='postSave()',
            on-cancel='close()')

      .content-block(
        ng-if='tableParams && !fixableSystems.length && mode === MODES.multi')
        .text-center
          strong
            i.fa.fa-check-circle.success.inline-right
            span(translate) No problems to fix on selected systems.
